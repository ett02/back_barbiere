import{c as T}from"./chunk-CZFM6TBO.js";import{a as F}from"./chunk-JIQ2QYEN.js";import{Ba as E,Bb as k,Db as A,Fa as v,La as d,Ma as r,Na as t,Nb as N,Pa as M,Qa as D,R as C,Ra as f,Sa as g,Ta as l,Ua as h,Va as b,Wa as S,X as m,Xa as n,Y as p,Ya as x,Za as u,fb as w,hb as P,ib as O,pa as s,yb as y,zb as I}from"./chunk-WQPBPXCL.js";function L(o,i){if(o&1){let e=f();r(0,"button",35),g("click",function(){m(e);let c=l().$implicit,_=l(3);return p(_.cancelAppointment(c.id))}),n(1," \u274C Cancella Appuntamento "),t()}}function V(o,i){if(o&1&&(r(0,"div",29)(1,"div",30)(2,"span",31),n(3),t(),r(4,"span",32),n(5),t()(),r(6,"div",33)(7,"p")(8,"strong"),n(9,"Barbiere:"),t(),n(10),t(),r(11,"p")(12,"strong"),n(13,"Data:"),t(),n(14),w(15,"date"),t(),r(16,"p")(17,"strong"),n(18,"Orario:"),t(),n(19),t(),r(20,"p")(21,"strong"),n(22,"Durata:"),t(),n(23),t()(),v(24,L,2,0,"button",34),t()),o&2){let e=i.$implicit,a=l(3);s(3),x(a.getServiceName(e.service)),s(),S(a.getAppointmentStatusClass(e)),s(),u(" ",e.stato||"PENDING"," "),s(5),u(" ",a.getBarberFullName(e.barber)),s(4),u(" ",P(15,9,e.data,"dd/MM/yyyy")),s(5),u(" ",e.orarioInizio),s(4),u(" ",a.getServiceDuration(e.service)),s(),d("ngIf",a.isUpcoming(e))}}function B(o,i){if(o&1&&(M(0),r(1,"div",27),v(2,V,25,12,"div",28),t(),D()),o&2){let e=l(2);s(2),d("ngForOf",e.filteredAppointments)}}function U(o,i){if(o&1){let e=f();r(0,"section",21)(1,"div",22)(2,"h2"),n(3,"\u{1F4CB} I Miei Appuntamenti"),t(),r(4,"div",23)(5,"button",24),g("click",function(){m(e);let c=l();return p(c.setFilter("UPCOMING"))}),n(6," Da fare "),t(),r(7,"button",24),g("click",function(){m(e);let c=l();return p(c.setFilter("CANCELED"))}),n(8," Annullati "),t(),r(9,"button",24),g("click",function(){m(e);let c=l();return p(c.setFilter("PAST"))}),n(10," Passati "),t()()(),r(11,"p",25),n(12),t(),v(13,B,3,1,"ng-container",26),t()}if(o&2){let e=l(),a=h(19);s(5),b("active",e.selectedFilter==="UPCOMING"),s(2),b("active",e.selectedFilter==="CANCELED"),s(2),b("active",e.selectedFilter==="PAST"),s(3),x(e.getCurrentFilterMessage()),s(),d("ngIf",e.filteredAppointments.length>0)("ngIfElse",a)}}function W(o,i){o&1&&(r(0,"p"),n(1,"Non hai appuntamenti confermati da fare."),t())}function G(o,i){o&1&&(r(0,"p"),n(1,"Non ci sono appuntamenti annullati."),t())}function R(o,i){o&1&&(r(0,"p"),n(1,"Non ci sono appuntamenti passati da mostrare."),t())}function Y(o,i){if(o&1&&(r(0,"div",36)(1,"span",37),n(2,"\u{1F4C2}"),t(),v(3,W,2,0,"p",38)(4,G,2,0,"p",38)(5,R,2,0,"p",38),t()),o&2){let e=l();s(3),d("ngIf",e.selectedFilter==="UPCOMING"),s(),d("ngIf",e.selectedFilter==="CANCELED"),s(),d("ngIf",e.selectedFilter==="PAST")}}function $(o,i){if(o&1){let e=f();r(0,"section",39)(1,"div",40)(2,"span",37),n(3,"\u{1F4C5}"),t(),r(4,"h3"),n(5,"Nessun Appuntamento"),t(),r(6,"p"),n(7,"Non hai ancora prenotato nessun servizio. Prenota ora per il tuo taglio perfetto!"),t(),r(8,"button",41),g("click",function(){m(e);let c=l();return p(c.navigateToBooking())}),n(9,"\u2702\uFE0F Prenota Subito"),t()()()}}function j(o,i){if(o&1){let e=f();r(0,"div",45)(1,"div",46)(2,"span",47),n(3),t(),r(4,"span",48),n(5),t()(),r(6,"p")(7,"strong"),n(8,"Barbiere:"),t(),n(9),t(),r(10,"p")(11,"strong"),n(12,"Data Richiesta:"),t(),n(13),w(14,"date"),t(),r(15,"p",49),n(16),t(),r(17,"button",50),g("click",function(){let c=m(e).$implicit,_=l(2);return p(_.removeFromWaitingList(c.id))}),n(18," \u{1F5D1}\uFE0F Rimuovi dalla Coda "),t()()}if(o&2){let e=i.$implicit,a=i.index,c=l(2);s(3),x(c.getServiceName(e.service)),s(2),u("Posizione: ",a+1),s(4),u(" ",c.getBarberFullName(e.barber)),s(4),u(" ",P(14,5,e.dataRichiesta,"dd/MM/yyyy")),s(3),x(c.getWaitingStatusMessage(e))}}function q(o,i){if(o&1&&(r(0,"section",42)(1,"h2"),n(2,"\u23F3 Lista d'Attesa"),t(),r(3,"div",43),v(4,j,19,8,"div",44),t()()),o&2){let e=l();s(4),d("ngForOf",e.waitingList)}}var z=class o{apiService=C(F);authService=C(N);router=C(T);customerName="Cliente";appointments=[];waitingList=[];selectedFilter="UPCOMING";ngOnInit(){let i=this.authService.getDecodedToken();i&&i.sub&&(this.customerName=i.sub.split("@")[0]),this.loadAppointments(),this.loadWaitingList()}loadAppointments(){let i=this.authService.getDecodedToken();if(i){let e=i.id;if(typeof e!="number"){console.error("User ID is missing in the decoded token.");return}this.apiService.getAppointmentsByUserId(e).subscribe(a=>{this.appointments=a},a=>{console.error("Error fetching appointments:",a)})}}loadWaitingList(){let i=this.authService.getDecodedToken();if(i){let e=i.id;if(typeof e!="number"){console.error("User ID is missing in the decoded token.");return}this.apiService.getWaitingListByCustomerId(e).subscribe(a=>{this.waitingList=a},a=>{console.error("Error fetching waiting list:",a)})}}navigateToBooking(){this.router.navigate(["/book"])}cancelAppointment(i){confirm("Sei sicuro di voler cancellare questo appuntamento?")&&this.apiService.cancelAppointment(i).subscribe(()=>{this.loadAppointments()},e=>{console.error("Error canceling appointment:",e)})}removeFromWaitingList(i){confirm("Vuoi rimuoverti dalla lista d'attesa?")&&this.apiService.removeFromWaitingList(i).subscribe(()=>{this.loadWaitingList()},e=>{console.error("Error removing from waiting list:",e)})}getServiceName(i){return i?.nome??"Servizio"}getServiceDuration(i){return i?.durata!=null?`${i.durata} min`:"--"}getAppointmentStatusClass(i){return`badge-${i.stato?.toLowerCase()??"pending"}`}getBarberFullName(i){if(!i)return"Non assegnato";let e=[i.nome,i.cognome].filter(Boolean);return e.length>0?e.join(" "):"Non assegnato"}getWaitingStatusMessage(i){switch(i.stato){case"IN_ATTESA":return"In attesa di disponibilit\xE0";case"NOTIFICATO":return"Hai ricevuto una notifica di disponibilit\xE0";case"CONFERMATO":return"Appuntamento confermato";case"SCADUTO":return"La richiesta \xE8 scaduta";case"ANNULLATO":return"Richiesta annullata";default:return"Stato non disponibile"}}logout(){this.authService.logout(),this.router.navigate(["/login"])}setFilter(i){this.selectedFilter=i}isUpcoming(i){if(i.stato!=="CONFERMATO")return!1;let e=this.getAppointmentDateTime(i);return!!e&&e>=new Date}get filteredAppointments(){return this.appointments.filter(i=>{let e=this.getAppointmentDateTime(i);switch(this.selectedFilter){case"UPCOMING":return this.isUpcoming(i);case"CANCELED":return i.stato==="ANNULLATO";case"PAST":return i.stato!=="ANNULLATO"&&!!e&&e<new Date;default:return!1}})}getCurrentFilterMessage(){switch(this.selectedFilter){case"UPCOMING":return"Mostro solo gli appuntamenti confermati da svolgere";case"CANCELED":return"Mostro gli appuntamenti annullati";case"PAST":return"Mostro gli appuntamenti gi\xE0 passati";default:return""}}getAppointmentDateTime(i){let e=i.data instanceof Date?i.data.toISOString().split("T")[0]:i.data;if(!e||!i.orarioInizio)return null;let a=new Date(`${e}T${i.orarioInizio}`);return isNaN(a.getTime())?null:a}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=E({type:o,selectors:[["app-customer-dashboard"]],decls:77,vars:5,consts:[["emptyFiltered",""],["noAppointments",""],[1,"dashboard-container"],[1,"dashboard-header"],[1,"dashboard-user"],[1,"user-icon"],[1,"user-name"],[1,"btn","btn-secondary","logout-button",3,"click"],[1,"hero-section"],[1,"hero-content"],[1,"welcome-title"],[1,"welcome-subtitle"],[1,"btn","btn-primary","btn-large",3,"click"],["class","appointments-section",4,"ngIf","ngIfElse"],["class","waiting-list-section",4,"ngIf"],[1,"why-choose-us"],[1,"features-grid"],[1,"feature-card"],[1,"feature-icon"],[1,"cta-section"],[1,"cta-content"],[1,"appointments-section"],[1,"appointments-header"],["role","group","aria-label","Filtra appuntamenti",1,"filter-tabs"],["type","button",1,"filter-chip",3,"click"],[1,"filter-helper"],[4,"ngIf","ngIfElse"],[1,"appointments-grid"],["class","appointment-card",4,"ngFor","ngForOf"],[1,"appointment-card"],[1,"appointment-header"],[1,"service-name"],[1,"status-badge"],[1,"appointment-details"],["class","btn btn-secondary btn-cancel",3,"click",4,"ngIf"],[1,"btn","btn-secondary","btn-cancel",3,"click"],[1,"no-results"],[1,"empty-icon"],[4,"ngIf"],[1,"no-appointments"],[1,"empty-state"],[1,"btn","btn-primary",3,"click"],[1,"waiting-list-section"],[1,"waiting-list-cards"],["class","waiting-card",4,"ngFor","ngForOf"],[1,"waiting-card"],[1,"waiting-header"],[1,"waiting-service"],[1,"position-badge"],[1,"waiting-status"],[1,"btn","btn-outline",3,"click"]],template:function(e,a){if(e&1){let c=f();r(0,"div",2)(1,"header",3)(2,"div",4)(3,"span",5),n(4,"\u{1F464}"),t(),r(5,"span",6),n(6),t()(),r(7,"button",7),g("click",function(){return m(c),p(a.logout())}),n(8," \u{1F6AA} Logout "),t()(),r(9,"section",8)(10,"div",9)(11,"h1",10),n(12),t(),r(13,"p",11),n(14," Prenota il tuo taglio perfetto con i migliori barbieri della citt\xE0 "),t(),r(15,"button",12),g("click",function(){return m(c),p(a.navigateToBooking())}),n(16," \u{1F4C5} Prenota Ora "),t()()(),v(17,U,14,9,"section",13)(18,Y,6,3,"ng-template",null,0,O)(20,$,10,0,"ng-template",null,1,O)(22,q,5,1,"section",14),r(23,"section",15)(24,"h2"),n(25,"\u2728 Perch\xE9 Scegliere la Nostra Barberia"),t(),r(26,"div",16)(27,"div",17)(28,"div",18),n(29,"\u{1F468}\u200D\u{1F4BC}"),t(),r(30,"h3"),n(31,"Barbieri Esperti"),t(),r(32,"p"),n(33,"Professionisti con oltre 10 anni di esperienza nel settore"),t()(),r(34,"div",17)(35,"div",18),n(36,"\u23F0"),t(),r(37,"h3"),n(38,"Prenotazione Online"),t(),r(39,"p"),n(40,"Prenota quando vuoi, 24/7, con conferma immediata"),t()(),r(41,"div",17)(42,"div",18),n(43,"\u{1F48E}"),t(),r(44,"h3"),n(45,"Servizi Premium"),t(),r(46,"p"),n(47,"Prodotti di alta qualit\xE0 e trattamenti personalizzati"),t()(),r(48,"div",17)(49,"div",18),n(50,"\u{1F3C6}"),t(),r(51,"h3"),n(52,"Miglior Prezzo"),t(),r(53,"p"),n(54,"Qualit\xE0 superiore a prezzi competitivi e convenienti"),t()(),r(55,"div",17)(56,"div",18),n(57,"\u{1F3AF}"),t(),r(58,"h3"),n(59,"Stile su Misura"),t(),r(60,"p"),n(61,"Consulenza personalizzata per il taglio perfetto per te"),t()(),r(62,"div",17)(63,"div",18),n(64,"\u{1F514}"),t(),r(65,"h3"),n(66,"Lista d'Attesa"),t(),r(67,"p"),n(68,"Sistema FIFO automatico se il giorno \xE8 pieno"),t()()()(),r(69,"section",19)(70,"div",20)(71,"h2"),n(72,"\u{1F680} Pronto per il Tuo Nuovo Look?"),t(),r(73,"p"),n(74,"Prenota ora e vivi l'esperienza della migliore barberia della citt\xE0!"),t(),r(75,"button",12),g("click",function(){return m(c),p(a.navigateToBooking())}),n(76," \u2702\uFE0F Prenota il Tuo Servizio "),t()()()()}if(e&2){let c=h(21);s(6),x(a.customerName),s(6),u("\u{1F488} Benvenuto, ",a.customerName,"!"),s(5),d("ngIf",a.appointments.length>0)("ngIfElse",c),s(5),d("ngIf",a.waitingList.length>0)}},dependencies:[A,y,I,k],styles:[".dashboard-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,beige,#e8e8d0)}.dashboard-header[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;padding:var(--spacing-sm) var(--spacing-lg);gap:var(--spacing-md);background:#fffffff2;box-shadow:var(--shadow-sm)}.dashboard-user[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-xs);color:var(--color-text-secondary);font-weight:600}.user-icon[_ngcontent-%COMP%]{font-size:1.5rem}.logout-button[_ngcontent-%COMP%]{border:none;border-radius:var(--radius-full, 999px);font-weight:600;padding:var(--spacing-xs) var(--spacing-lg);transition:transform var(--transition-fast)}.logout-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.hero-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--color-primary) 0%,var(--color-primary-hover) 100%);padding:var(--spacing-xl) var(--spacing-md);text-align:center;color:var(--color-white);box-shadow:0 4px 20px #0000001a;margin-bottom:var(--spacing-xl)}.welcome-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;margin-bottom:var(--spacing-sm);animation:_ngcontent-%COMP%_fadeInDown .6s ease}.welcome-subtitle[_ngcontent-%COMP%]{font-size:var(--font-size-h4);margin-bottom:var(--spacing-lg);opacity:.95;animation:_ngcontent-%COMP%_fadeInUp .8s ease}.btn-large[_ngcontent-%COMP%]{padding:var(--spacing-md) var(--spacing-xl);font-size:var(--font-size-h4);background:var(--color-white);color:var(--color-primary);border:none;font-weight:700}.btn-large[_ngcontent-%COMP%]:hover{background:var(--color-background);transform:translateY(-4px);box-shadow:0 8px 24px #0003}.appointments-section[_ngcontent-%COMP%], .waiting-list-section[_ngcontent-%COMP%], .why-choose-us[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto var(--spacing-xl);padding:0 var(--spacing-md)}.appointments-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .waiting-list-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .why-choose-us[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:var(--color-text-primary);margin-bottom:var(--spacing-lg);font-size:var(--font-size-h2)}.appointments-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:var(--spacing-md);margin-bottom:var(--spacing-xs)}.appointments-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;text-align:left}.filter-tabs[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-xs);flex-wrap:wrap}.filter-chip[_ngcontent-%COMP%]{border:1px solid var(--color-border);background:var(--color-white);color:var(--color-text-primary);padding:8px 12px;border-radius:var(--radius-full, 999px);font-weight:700;letter-spacing:.01em;cursor:pointer;transition:all var(--transition-fast)}.filter-chip[_ngcontent-%COMP%]:hover{border-color:var(--color-primary);color:var(--color-primary);transform:translateY(-1px)}.filter-chip.active[_ngcontent-%COMP%]{background:var(--color-primary);color:var(--color-white);border-color:var(--color-primary);box-shadow:0 6px 18px #00000014}.filter-helper[_ngcontent-%COMP%]{margin:0 0 var(--spacing-md);color:var(--color-text-secondary);text-align:left}.appointments-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:var(--spacing-md)}.appointment-card[_ngcontent-%COMP%]{background:var(--color-white);padding:var(--spacing-lg);border-radius:var(--radius-lg);box-shadow:var(--shadow-md);transition:all var(--transition-normal)}.appointment-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:var(--shadow-lg)}.appointment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-md);padding-bottom:var(--spacing-sm);border-bottom:2px solid var(--color-border)}.service-name[_ngcontent-%COMP%]{font-size:var(--font-size-h4);font-weight:700;color:var(--color-text-primary)}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:var(--radius-sm);font-size:var(--font-size-small);font-weight:600;text-transform:uppercase}.badge-confirmato[_ngcontent-%COMP%]{background:#4caf50;color:var(--color-white)}.badge-pending[_ngcontent-%COMP%]{background:orange;color:var(--color-white)}.badge-annullato[_ngcontent-%COMP%]{background:#f44336;color:var(--color-white)}.appointment-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:var(--spacing-xs) 0;color:var(--color-text-secondary)}.btn-cancel[_ngcontent-%COMP%]{width:100%;margin-top:var(--spacing-md)}.no-appointments[_ngcontent-%COMP%]{max-width:600px;margin:var(--spacing-xl) auto;padding:0 var(--spacing-md)}.no-results[_ngcontent-%COMP%]{text-align:center;padding:var(--spacing-lg);color:var(--color-text-secondary);background:var(--color-white);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);margin-bottom:var(--spacing-lg)}.empty-state[_ngcontent-%COMP%]{background:var(--color-white);padding:var(--spacing-xl);border-radius:var(--radius-lg);text-align:center;box-shadow:var(--shadow-md)}.empty-icon[_ngcontent-%COMP%]{font-size:5rem;display:block;margin-bottom:var(--spacing-md)}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--color-text-primary);margin-bottom:var(--spacing-sm)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-secondary);margin-bottom:var(--spacing-lg)}.waiting-list-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:var(--spacing-md)}.waiting-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff8f0,#fff);padding:var(--spacing-lg);border-radius:var(--radius-lg);box-shadow:var(--shadow-md);border-left:4px solid var(--color-primary)}.waiting-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-md)}.waiting-service[_ngcontent-%COMP%]{font-weight:700;color:var(--color-text-primary)}.position-badge[_ngcontent-%COMP%]{background:var(--color-primary);color:var(--color-white);padding:4px 10px;border-radius:var(--radius-sm);font-size:var(--font-size-small);font-weight:600}.waiting-status[_ngcontent-%COMP%]{color:var(--color-primary);font-style:italic;margin:var(--spacing-sm) 0}.btn-outline[_ngcontent-%COMP%]{background:transparent;border:2px solid var(--color-primary);color:var(--color-primary);width:100%;margin-top:var(--spacing-md)}.btn-outline[_ngcontent-%COMP%]:hover{background:var(--color-primary);color:var(--color-white)}.features-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:var(--spacing-md)}.feature-card[_ngcontent-%COMP%]{background:var(--color-white);padding:var(--spacing-lg);border-radius:var(--radius-lg);box-shadow:var(--shadow-md);text-align:center;transition:all var(--transition-normal)}.feature-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:var(--shadow-lg);border-top:4px solid var(--color-primary)}.feature-icon[_ngcontent-%COMP%]{font-size:3.5rem;margin-bottom:var(--spacing-sm)}.feature-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--color-text-primary);margin-bottom:var(--spacing-xs);font-size:var(--font-size-h4)}.feature-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-secondary);font-size:var(--font-size-small)}.cta-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--color-primary) 0%,var(--color-primary-active) 100%);padding:var(--spacing-xl) var(--spacing-md);text-align:center;margin-top:var(--spacing-xl)}.cta-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--color-white);margin-bottom:var(--spacing-sm);font-size:var(--font-size-h2)}.cta-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-white);opacity:.95;margin-bottom:var(--spacing-lg);font-size:var(--font-size-h4)}@keyframes _ngcontent-%COMP%_fadeInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.welcome-title[_ngcontent-%COMP%]{font-size:1.8rem}.features-grid[_ngcontent-%COMP%], .appointments-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.appointments-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.filter-tabs[_ngcontent-%COMP%]{width:100%}}"]})};export{z as CustomerDashboardComponent};
