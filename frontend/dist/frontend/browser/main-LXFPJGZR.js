import{a as E,b as O,c as k,d as A,e as L,f as N,i as D,j as M}from"./chunk-NK4S2GEF.js";import{a as K,b as ee,c as f,d as _,e as te,f as ne,g as oe}from"./chunk-BMBIHSAK.js";import{$a as y,Ia as d,Ma as h,Nb as P,Ob as Z,P as q,Rb as b,Ta as C,U as l,Ua as t,Va as o,W as V,Wa as G,Xa as j,Ya as z,Yb as Q,Zb as X,_a as x,_b as $,ac as v,fb as r,hb as U,kb as c,lb as g,mb as u,ob as J,pb as S,qb as w,ta as m,ub as Y}from"./chunk-TMWIUII4.js";var R=class e{intercept(i,n){let a=localStorage.getItem("token");if(a){let p=i.clone({headers:i.headers.set("Authorization",`Bearer ${a}`)});return n.handle(p)}else return n.handle(i)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=q({token:e,factory:e.\u0275fac})};function le(e,i){if(e&1&&(t(0,"div",15),r(1),o()),e&2){let n=y();m(),U(" ",n.errorMessage," ")}}var T=class e{authService=l(v);router=l(f);credentials={email:"",password:""};errorMessage="";login(){console.log("Sending login request with:",this.credentials),this.authService.login(this.credentials).subscribe(i=>{if(console.log("Login successful - Full response:",i),console.log("JWT from response:",i.jwt),!i.jwt){console.error("No JWT in response!"),alert("Errore: JWT mancante nella risposta");return}let n=this.authService.saveSession(i.jwt);if(!n){alert("Errore durante il salvataggio della sessione. Effettua nuovamente il login.");return}if(console.log("Decoded token:",n),!n||!n.role){console.error("Cannot decode token or role missing"),alert("Errore: impossibile decodificare il token");return}n.role==="ADMIN"?(console.log("Navigating to admin-dashboard"),this.router.navigate(["/admin-dashboard"])):(console.log("Navigating to customer-dashboard"),this.router.navigate(["/customer-dashboard"]))},i=>{console.error("Login failed - Full error:",i),console.error("Error status:",i.status),console.error("Error message:",i.error),this.errorMessage="Credenziali non valide",alert("Login fallito: "+(i.error?.message||"Credenziali errate"))})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-login"]],decls:28,vars:3,consts:[[1,"login-container"],[1,"login-card"],[1,"login-logo"],["class","error-message",4,"ngIf"],[1,"login-form",3,"ngSubmit"],[1,"form-group"],["for","email",1,"form-label"],["type","email","id","email","name","email","placeholder","esempio@email.com","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],["type","password","id","password","name","password","placeholder","password","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"login-actions"],["type","submit",1,"btn","btn-primary","btn-full-width"],[1,"login-divider"],[1,"login-footer"],["routerLink","/register"],[1,"error-message"]],template:function(n,a){n&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),r(4,"\u{1F488} Barbershop"),o(),t(5,"p"),r(6,"Accedi al tuo account"),o()(),h(7,le,2,1,"div",3),t(8,"form",4),x("ngSubmit",function(){return a.login()}),t(9,"div",5)(10,"label",6),r(11,"Email"),o(),t(12,"input",7),u("ngModelChange",function(s){return g(a.credentials.email,s)||(a.credentials.email=s),s}),o()(),t(13,"div",5)(14,"label",8),r(15,"Password"),o(),t(16,"input",9),u("ngModelChange",function(s){return g(a.credentials.password,s)||(a.credentials.password=s),s}),o()(),t(17,"div",10)(18,"button",11),r(19,"Accedi"),o()()(),t(20,"div",12)(21,"span"),r(22,"oppure"),o()(),t(23,"div",13)(24,"p"),r(25,"Non hai un account? "),t(26,"a",14),r(27,"Registrati"),o()()()()()),n&2&&(m(7),C("ngIf",a.errorMessage),m(5),c("ngModel",a.credentials.email),m(4),c("ngModel",a.credentials.password))},dependencies:[M,N,E,O,k,D,L,A,b,P,_],styles:['.login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:var(--spacing-md)}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:var(--spacing-xl) var(--spacing-lg);background:var(--color-surface);backdrop-filter:blur(var(--glass-blur));-webkit-backdrop-filter:blur(var(--glass-blur));border:1px solid var(--color-surface-border);box-shadow:var(--glass-shadow);border-radius:var(--radius-xl);animation:_ngcontent-%COMP%_fadeInUp .6s cubic-bezier(.2,.8,.2,1)}.login-logo[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--spacing-xl)}.login-logo[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;color:var(--color-primary);margin-bottom:var(--spacing-xs);letter-spacing:-.5px}.login-logo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-secondary);font-size:1rem;font-weight:500}.login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-md)}.login-actions[_ngcontent-%COMP%]{margin-top:var(--spacing-sm);display:flex;flex-direction:column;gap:var(--spacing-md)}.login-divider[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center;color:var(--color-text-secondary);font-size:.875rem;margin:var(--spacing-sm) 0}.login-divider[_ngcontent-%COMP%]:before, .login-divider[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid rgba(0,0,0,.1)}.login-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 var(--spacing-sm)}.login-footer[_ngcontent-%COMP%]{text-align:center;margin-top:var(--spacing-lg);font-size:.875rem;color:var(--color-text-secondary)}.error-message[_ngcontent-%COMP%]{background:#d32f2f1a;color:var(--color-error);padding:var(--spacing-sm);border-radius:var(--radius-md);text-align:center;font-weight:500;font-size:.9rem;border:1px solid rgba(211,47,47,.2);animation:_ngcontent-%COMP%_shake .4s cubic-bezier(.36,.07,.19,.97) both}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(40px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_shake{10%,90%{transform:translate3d(-1px,0,0)}20%,80%{transform:translate3d(2px,0,0)}30%,50%,70%{transform:translate3d(-4px,0,0)}40%,60%{transform:translate3d(4px,0,0)}}']})};var W=class e{authService=l(v);router=l(f);user={nome:"",cognome:"",email:"",password:"",ruolo:"CLIENTE"};register(){this.authService.register(this.user).subscribe(()=>{this.router.navigate(["/login"])},i=>{console.error("Registration failed",i)})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-register"]],decls:25,vars:4,consts:[[1,"register-container"],[1,"register-form"],[3,"ngSubmit"],[1,"form-group"],["for","nome"],["type","text","id","nome","name","nome","required","",3,"ngModelChange","ngModel"],["for","cognome"],["type","text","id","cognome","name","cognome","required","",3,"ngModelChange","ngModel"],["for","email"],["type","email","id","email","name","email","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","required","",3,"ngModelChange","ngModel"],["type","submit"],["routerLink","/login"]],template:function(n,a){n&1&&(t(0,"div",0)(1,"div",1)(2,"h2"),r(3,"Registrazione"),o(),t(4,"form",2),x("ngSubmit",function(){return a.register()}),t(5,"div",3)(6,"label",4),r(7,"Nome"),o(),t(8,"input",5),u("ngModelChange",function(s){return g(a.user.nome,s)||(a.user.nome=s),s}),o()(),t(9,"div",3)(10,"label",6),r(11,"Cognome"),o(),t(12,"input",7),u("ngModelChange",function(s){return g(a.user.cognome,s)||(a.user.cognome=s),s}),o()(),t(13,"div",3)(14,"label",8),r(15,"Email"),o(),t(16,"input",9),u("ngModelChange",function(s){return g(a.user.email,s)||(a.user.email=s),s}),o()(),t(17,"div",3)(18,"label",10),r(19,"Password"),o(),t(20,"input",11),u("ngModelChange",function(s){return g(a.user.password,s)||(a.user.password=s),s}),o()(),t(21,"button",12),r(22,"Registrati"),o(),t(23,"a",13),r(24,"Hai gi\xE0 un account? Accedi"),o()()()()),n&2&&(m(8),c("ngModel",a.user.nome),m(4),c("ngModel",a.user.cognome),m(4),c("ngModel",a.user.email),m(4),c("ngModel",a.user.password))},dependencies:[M,N,E,O,k,D,L,A,b,_],styles:[".register-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.register-form[_ngcontent-%COMP%]{padding:40px;border-radius:10px;background-color:#fff;box-shadow:0 0 10px #0000001a;width:300px}.register-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.register-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:20px}.register-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px}.register-form[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;text-align:center;margin-top:20px}"]})};var ie=()=>{let e=l(v),i=l(f);return e.isAdminAuthenticated()?!0:(e.logout(),i.navigate(["/login"]),!1)};var re=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:T},{path:"register",component:W},{path:"admin-dashboard",loadComponent:()=>import("./chunk-KSMYQWLH.js").then(e=>e.AdminDashboardComponent),canActivate:[ie]},{path:"customer-dashboard",loadComponent:()=>import("./chunk-7F6P4J2F.js").then(e=>e.CustomerDashboardComponent)},{path:"book",loadComponent:()=>import("./chunk-FVZQURUX.js").then(e=>e.ServiceBookingComponent)},{path:"appointments",loadComponent:()=>import("./chunk-SM3CFY45.js").then(e=>e.AppointmentListComponent)}];var ae={providers:[Y({eventCoalescing:!0}),ne(re),X($()),V(M),{provide:Q,useClass:R,multi:!0}]};var pe=()=>({exact:!0});function de(e,i){e&1&&(j(0),t(1,"a",6)(2,"span",4),r(3,"\u{1F3E0}"),o(),t(4,"span",5),r(5,"Home"),o()(),t(6,"a",7)(7,"span",4),r(8,"\u2702\uFE0F"),o(),t(9,"span",5),r(10,"Prenota"),o()(),t(11,"a",8)(12,"span",4),r(13,"\u{1F4C5}"),o(),t(14,"span",5),r(15,"Appuntamenti"),o()(),z()),e&2&&(m(),C("routerLinkActiveOptions",J(1,pe)))}function ce(e,i){e&1&&(j(0),t(1,"a",9)(2,"span",4),r(3,"\u{1F4CA}"),o(),t(4,"span",5),r(5,"Dashboard"),o()(),z())}function ge(e,i){if(e&1&&(t(0,"nav",1),h(1,de,16,2,"ng-container",2),S(2,"async"),h(3,ce,6,0,"ng-container",2),S(4,"async"),t(5,"a",3)(6,"span",4),r(7,"\u{1F464}"),o(),t(8,"span",5),r(9,"Profilo"),o()()()),e&2){let n=y();m(),C("ngIf",w(2,2,n.isAdmin$)===!1),m(2),C("ngIf",w(4,4,n.isAdmin$))}}var F=class e{authService=l(v);router=l(f);isLoggedIn$=this.authService.isLoggedIn$;isAdmin$=this.authService.isAdmin$;isActive(i){return this.router.url.includes(i)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-bottom-nav"]],decls:2,vars:3,consts:[["class","bottom-nav glass-panel",4,"ngIf"],[1,"bottom-nav","glass-panel"],[4,"ngIf"],["routerLink","/profile","routerLinkActive","active",1,"nav-item"],[1,"icon"],[1,"label"],["routerLink","/customer-dashboard","routerLinkActive","active",1,"nav-item",3,"routerLinkActiveOptions"],["routerLink","/book","routerLinkActive","active",1,"nav-item"],["routerLink","/appointments","routerLinkActive","active",1,"nav-item"],["routerLink","/admin-dashboard","routerLinkActive","active",1,"nav-item"]],template:function(n,a){n&1&&(h(0,ge,10,6,"nav",0),S(1,"async")),n&2&&C("ngIf",w(1,1,a.isLoggedIn$))},dependencies:[b,P,oe,_,te,Z],styles:[".bottom-nav[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;width:100%;height:var(--bottom-nav-height);display:flex;justify-content:space-around;align-items:center;z-index:1000;padding-bottom:env(safe-area-inset-bottom);border-bottom-left-radius:0;border-bottom-right-radius:0;border-top:1px solid var(--color-surface-border)}.nav-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;color:var(--color-text-secondary);font-size:.75rem;font-weight:500;padding:8px;border-radius:12px;transition:all var(--transition-fast);flex:1;height:100%}.nav-item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:4px;transition:transform var(--transition-fast)}.nav-item.active[_ngcontent-%COMP%]{color:var(--color-primary)}.nav-item.active[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{transform:translateY(-2px)}.nav-item[_ngcontent-%COMP%]:active{transform:scale(.95)}@media (min-width: 769px){.bottom-nav[_ngcontent-%COMP%]{display:none}}"]})};var B=class e{title="frontend";static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(n,a){n&1&&G(0,"router-outlet")(1,"app-bottom-nav")},dependencies:[ee,F],encapsulation:2})};K(B,ae).catch(e=>console.error(e));
