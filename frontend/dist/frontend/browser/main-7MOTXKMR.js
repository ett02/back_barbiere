import{a as _,b as y,c as w,d as S,e as x,f as P,i as E,j as C}from"./chunk-E6AAK6AK.js";import{a as q,b as U,c as f,d as b,e as J}from"./chunk-CZFM6TBO.js";import{Ba as u,Db as M,Fa as W,Jb as B,Kb as V,La as D,Lb as G,M as L,Ma as n,Na as a,Nb as h,Oa as I,R as p,Sa as v,T,Ta as F,Xa as s,Za as z,ab as d,bb as g,cb as c,kb as H,pa as l,zb as j}from"./chunk-WQPBPXCL.js";var O=class e{intercept(r,t){let o=localStorage.getItem("token");if(o){let m=r.clone({headers:r.headers.set("Authorization",`Bearer ${o}`)});return t.handle(m)}else return t.handle(r)}static \u0275fac=function(t){return new(t||e)};static \u0275prov=L({token:e,factory:e.\u0275fac})};function $(e,r){if(e&1&&(n(0,"div",15),s(1),a()),e&2){let t=F();l(),z(" ",t.errorMessage," ")}}var R=class e{authService=p(h);router=p(f);credentials={email:"",password:""};errorMessage="";login(){console.log("Sending login request with:",this.credentials),this.authService.login(this.credentials).subscribe(r=>{if(console.log("Login successful - Full response:",r),console.log("JWT from response:",r.jwt),!r.jwt){console.error("No JWT in response!"),alert("Errore: JWT mancante nella risposta");return}let t=this.authService.saveSession(r.jwt);if(!t){alert("Errore durante il salvataggio della sessione. Effettua nuovamente il login.");return}if(console.log("Decoded token:",t),!t||!t.role){console.error("Cannot decode token or role missing"),alert("Errore: impossibile decodificare il token");return}t.role==="ADMIN"?(console.log("Navigating to admin-dashboard"),this.router.navigate(["/admin-dashboard"])):(console.log("Navigating to customer-dashboard"),this.router.navigate(["/customer-dashboard"]))},r=>{console.error("Login failed - Full error:",r),console.error("Error status:",r.status),console.error("Error message:",r.error),this.errorMessage="Credenziali non valide",alert("Login fallito: "+(r.error?.message||"Credenziali errate"))})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=u({type:e,selectors:[["app-login"]],decls:28,vars:3,consts:[[1,"login-container"],[1,"login-card"],[1,"login-logo"],["class","error-message",4,"ngIf"],[1,"login-form",3,"ngSubmit"],[1,"form-group"],["for","email",1,"form-label"],["type","email","id","email","name","email","placeholder","esempio@email.com","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],["type","password","id","password","name","password","placeholder","password","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"login-actions"],["type","submit",1,"btn","btn-primary","btn-full-width"],[1,"login-divider"],[1,"login-footer"],["routerLink","/register"],[1,"error-message"]],template:function(t,o){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),s(4,"\u{1F488} Barbershop"),a(),n(5,"p"),s(6,"Accedi al tuo account"),a()(),W(7,$,2,1,"div",3),n(8,"form",4),v("ngSubmit",function(){return o.login()}),n(9,"div",5)(10,"label",6),s(11,"Email"),a(),n(12,"input",7),c("ngModelChange",function(i){return g(o.credentials.email,i)||(o.credentials.email=i),i}),a()(),n(13,"div",5)(14,"label",8),s(15,"Password"),a(),n(16,"input",9),c("ngModelChange",function(i){return g(o.credentials.password,i)||(o.credentials.password=i),i}),a()(),n(17,"div",10)(18,"button",11),s(19,"Accedi"),a()()(),n(20,"div",12)(21,"span"),s(22,"oppure"),a()(),n(23,"div",13)(24,"p"),s(25,"Non hai un account? "),n(26,"a",14),s(27,"Registrati"),a()()()()()),t&2&&(l(7),D("ngIf",o.errorMessage),l(5),d("ngModel",o.credentials.email),l(4),d("ngModel",o.credentials.password))},dependencies:[C,P,_,y,w,E,x,S,M,j,b],styles:['.login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,beige,#e8e8d0);padding:var(--spacing-md)}.login-card[_ngcontent-%COMP%]{background:var(--color-white);border-radius:var(--radius-xl);padding:var(--spacing-xl);box-shadow:var(--shadow-lg);width:100%;max-width:450px;animation:_ngcontent-%COMP%_fadeInUp .5s ease}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.login-logo[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--spacing-lg)}.login-logo[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--font-size-h2);color:var(--color-primary);margin-bottom:var(--spacing-xs)}.login-logo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-secondary);font-size:var(--font-size-small)}.login-form[_ngcontent-%COMP%]{margin-bottom:var(--spacing-md)}.login-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-sm)}.login-divider[_ngcontent-%COMP%]{text-align:center;margin:var(--spacing-md) 0;position:relative}.login-divider[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:50%;width:100%;height:1px;background:var(--color-border)}.login-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:var(--color-white);padding:0 var(--spacing-sm);position:relative;color:var(--color-text-secondary);font-size:var(--font-size-small)}.login-footer[_ngcontent-%COMP%]{text-align:center;margin-top:var(--spacing-md);color:var(--color-text-secondary);font-size:var(--font-size-small)}.error-message[_ngcontent-%COMP%]{background:#ffebee;color:var(--color-error);padding:var(--spacing-sm);border-radius:var(--radius-md);margin-bottom:var(--spacing-md);text-align:center;font-size:var(--font-size-small);animation:_ngcontent-%COMP%_shake .3s}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(-10px)}75%{transform:translate(10px)}}@media (max-width: 768px){.login-card[_ngcontent-%COMP%]{padding:var(--spacing-md)}}']})};var k=class e{authService=p(h);router=p(f);user={nome:"",cognome:"",email:"",password:"",ruolo:"CLIENTE"};register(){this.authService.register(this.user).subscribe(()=>{this.router.navigate(["/login"])},r=>{console.error("Registration failed",r)})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=u({type:e,selectors:[["app-register"]],decls:25,vars:4,consts:[[1,"register-container"],[1,"register-form"],[3,"ngSubmit"],[1,"form-group"],["for","nome"],["type","text","id","nome","name","nome","required","",3,"ngModelChange","ngModel"],["for","cognome"],["type","text","id","cognome","name","cognome","required","",3,"ngModelChange","ngModel"],["for","email"],["type","email","id","email","name","email","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","required","",3,"ngModelChange","ngModel"],["type","submit"],["routerLink","/login"]],template:function(t,o){t&1&&(n(0,"div",0)(1,"div",1)(2,"h2"),s(3,"Registrazione"),a(),n(4,"form",2),v("ngSubmit",function(){return o.register()}),n(5,"div",3)(6,"label",4),s(7,"Nome"),a(),n(8,"input",5),c("ngModelChange",function(i){return g(o.user.nome,i)||(o.user.nome=i),i}),a()(),n(9,"div",3)(10,"label",6),s(11,"Cognome"),a(),n(12,"input",7),c("ngModelChange",function(i){return g(o.user.cognome,i)||(o.user.cognome=i),i}),a()(),n(13,"div",3)(14,"label",8),s(15,"Email"),a(),n(16,"input",9),c("ngModelChange",function(i){return g(o.user.email,i)||(o.user.email=i),i}),a()(),n(17,"div",3)(18,"label",10),s(19,"Password"),a(),n(20,"input",11),c("ngModelChange",function(i){return g(o.user.password,i)||(o.user.password=i),i}),a()(),n(21,"button",12),s(22,"Registrati"),a(),n(23,"a",13),s(24,"Hai gi\xE0 un account? Accedi"),a()()()()),t&2&&(l(8),d("ngModel",o.user.nome),l(4),d("ngModel",o.user.cognome),l(4),d("ngModel",o.user.email),l(4),d("ngModel",o.user.password))},dependencies:[C,P,_,y,w,E,x,S,M,b],styles:[".register-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.register-form[_ngcontent-%COMP%]{padding:40px;border-radius:10px;background-color:#fff;box-shadow:0 0 10px #0000001a;width:300px}.register-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.register-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:20px}.register-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px}.register-form[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;text-align:center;margin-top:20px}"]})};var Z=()=>{let e=p(h),r=p(f);return e.isAdminAuthenticated()?!0:(e.logout(),r.navigate(["/login"]),!1)};var K=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:R},{path:"register",component:k},{path:"admin-dashboard",loadComponent:()=>import("./chunk-RDD2O4YK.js").then(e=>e.AdminDashboardComponent),canActivate:[Z]},{path:"customer-dashboard",loadComponent:()=>import("./chunk-ZFQWOU4H.js").then(e=>e.CustomerDashboardComponent)},{path:"book",loadComponent:()=>import("./chunk-JRKTWU7C.js").then(e=>e.ServiceBookingComponent)},{path:"appointments",loadComponent:()=>import("./chunk-KXWLCDLE.js").then(e=>e.AppointmentListComponent)}];var Q={providers:[H({eventCoalescing:!0}),J(K),V(G()),T(C),{provide:B,useClass:O,multi:!0}]};var N=class e{title="frontend";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=u({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(t,o){t&1&&I(0,"router-outlet")},dependencies:[U],encapsulation:2})};q(N,Q).catch(e=>console.error(e));
