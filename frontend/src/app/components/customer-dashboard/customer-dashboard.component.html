<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="dashboard-user">
      <span class="user-icon">ğŸ‘¤</span>
      <span class="user-name">{{ customerName }}</span>
    </div>
    <button class="btn btn-secondary logout-button" (click)="logout()">
      ğŸšª Logout
    </button>
  </header>
  <!-- Hero Section con Benvenuto -->
  <section class="hero-section">
    <div class="hero-content">
      <h1 class="welcome-title">ğŸ’ˆ Benvenuto, {{ customerName }}!</h1>
      <p class="welcome-subtitle">
        Prenota il tuo taglio perfetto con i migliori barbieri della cittÃ 
      </p>
      <button class="btn btn-primary btn-large" (click)="navigateToBooking()">
        ğŸ“… Prenota Ora
      </button>
    </div>
  </section>

  <!-- I Miei Appuntamenti -->
  <section class="appointments-section" *ngIf="appointments.length > 0; else noAppointments">
    <div class="appointments-header">
      <h2>ğŸ“‹ I Miei Appuntamenti</h2>
      <div class="filter-tabs" role="group" aria-label="Filtra appuntamenti">
        <button
          type="button"
          class="filter-chip"
          [class.active]="selectedFilter === 'UPCOMING'"
          (click)="setFilter('UPCOMING')"
        >
          Da fare
        </button>
        <button
          type="button"
          class="filter-chip"
          [class.active]="selectedFilter === 'CANCELED'"
          (click)="setFilter('CANCELED')"
        >
          Annullati
        </button>
        <button
          type="button"
          class="filter-chip"
          [class.active]="selectedFilter === 'PAST'"
          (click)="setFilter('PAST')"
        >
          Passati
        </button>
      </div>
    </div>
    <p class="filter-helper">{{ getCurrentFilterMessage() }}</p>

    <ng-container
      *ngIf="
        (appointments | appointmentFilter: selectedFilter).length > 0;
        else emptyFiltered
      "
    >
      <div class="appointments-grid">
        <div
          class="appointment-card"
          *ngFor="
            let appointment of appointments | appointmentFilter: selectedFilter
          "
        >
          <div class="appointment-header">
            <span class="service-name">{{
              getServiceName(appointment.service)
            }}</span>
            <span class="status-badge" [class]="getAppointmentStatusClass(appointment)">
              {{ appointment.stato || 'PENDING' }}
            </span>
          </div>
          <div class="appointment-details">
            <p><strong>Barbiere:</strong> {{ getBarberFullName(appointment.barber) }}</p>
            <p><strong>Data:</strong> {{ appointment.data | date: 'dd/MM/yyyy' }}</p>
            <p><strong>Orario:</strong> {{ appointment.orarioInizio }}</p>
            <p><strong>Durata:</strong> {{ getServiceDuration(appointment.service) }}</p>
          </div>
          <button
            class="btn btn-secondary btn-cancel"
            *ngIf="isUpcoming(appointment)"
            (click)="cancelAppointment(appointment.id)"
          >
            âŒ Cancella Appuntamento
          </button>
        </div>
      </div>
    </ng-container>
  </section>

  <ng-template #emptyFiltered>
    <div class="no-results">
      <span class="empty-icon">ğŸ“‚</span>
      <p *ngIf="selectedFilter === 'UPCOMING'">Non hai appuntamenti confermati da fare.</p>
      <p *ngIf="selectedFilter === 'CANCELED'">Non ci sono appuntamenti annullati.</p>
      <p *ngIf="selectedFilter === 'PAST'">Non ci sono appuntamenti passati da mostrare.</p>
    </div>
  </ng-template>

  <!-- Messaggio se nessun appuntamento in assoluto -->
  <ng-template #noAppointments>
    <section class="no-appointments">
      <div class="empty-state">
        <span class="empty-icon">ğŸ“…</span>
        <h3>Nessun Appuntamento</h3>
        <p>Non hai ancora prenotato nessun servizio. Prenota ora per il tuo taglio perfetto!</p>
        <button class="btn btn-primary" (click)="navigateToBooking()">âœ‚ï¸ Prenota Subito</button>
      </div>
    </section>
  </ng-template>

  <!-- Lista d'Attesa -->
  <section class="waiting-list-section" *ngIf="waitingList.length > 0">
    <h2>â³ Lista d'Attesa</h2>
    <div class="waiting-list-cards">
      <div class="waiting-card" *ngFor="let waiting of waitingList; let i = index">
        <div class="waiting-header">
          <span class="waiting-service">{{ getServiceName(waiting.service) }}</span>
          <span class="position-badge">Posizione: {{ i + 1 }}</span>
        </div>
        <p><strong>Barbiere:</strong> {{ getBarberFullName(waiting.barber) }}</p>
        <p><strong>Data Richiesta:</strong> {{ waiting.dataRichiesta | date: 'dd/MM/yyyy' }}</p>
        <p class="waiting-status">{{ getWaitingStatusMessage(waiting) }}</p>
        <button class="btn btn-outline" (click)="removeFromWaitingList(waiting.id)">
          ğŸ—‘ï¸ Rimuovi dalla Coda
        </button>
      </div>
    </div>
  </section>

  <!-- PerchÃ© Scegliere Noi -->
  <section class="why-choose-us">
    <h2>âœ¨ PerchÃ© Scegliere la Nostra Barberia</h2>
    <div class="features-grid">
      <div class="feature-card">
        <div class="feature-icon">ğŸ‘¨â€ğŸ’¼</div>
        <h3>Barbieri Esperti</h3>
        <p>Professionisti con oltre 10 anni di esperienza nel settore</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">â°</div>
        <h3>Prenotazione Online</h3>
        <p>Prenota quando vuoi, 24/7, con conferma immediata</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">ğŸ’</div>
        <h3>Servizi Premium</h3>
        <p>Prodotti di alta qualitÃ  e trattamenti personalizzati</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">ğŸ†</div>
        <h3>Miglior Prezzo</h3>
        <p>QualitÃ  superiore a prezzi competitivi e convenienti</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">ğŸ¯</div>
        <h3>Stile su Misura</h3>
        <p>Consulenza personalizzata per il taglio perfetto per te</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">ğŸ””</div>
        <h3>Lista d'Attesa</h3>
        <p>Sistema FIFO automatico se il giorno Ã¨ pieno</p>
      </div>
    </div>
  </section>

  <!-- Call to Action Finale -->
  <section class="cta-section">
    <div class="cta-content">
      <h2>ğŸš€ Pronto per il Tuo Nuovo Look?</h2>
      <p>Prenota ora e vivi l'esperienza della migliore barberia della cittÃ !</p>
      <button class="btn btn-primary btn-large" (click)="navigateToBooking()">
        âœ‚ï¸ Prenota il Tuo Servizio
      </button>
    </div>
  </section>
</div>
